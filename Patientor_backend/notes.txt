utils 60 line refactored.